---
title: "セキュリティインシデント擬似体験から学ぶ社内の効果的なログ基盤"
emoji: "🛕"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: ["AWS", "セキュリティ", "インシデント", "ログ", "log"]
published: false
publication_name: "levtech"
---

# はじめに
皆さん、こんにちは。レバテック開発部レバテックプラットフォーム開発チームに所属している内藤です。

普段は、バックエンドの設計や実装、さらにインフラの構築まで幅広く担当しています。
最近、私は弊社開発部を代表して（色々な方面から怒られそう笑）、AWSセキュリティインシデント擬似体験GameDayに参加する機会に恵まれました。このイベントでは、セキュリティインシデントへの対応方法や予防策など、実際のインシデント調査以上の学びを得ました。

そこで、この記事を通して、セキュリティインシデントへの対応に関する基本的な考え方や対策の重要性について共有したいと思います。セキュリティは技術的な知識だけではなく、組織全体の意識や体制の整備も不可欠です。私の経験が、皆さんの組織におけるセキュリティ対策に有益なヒントとなれば幸いです。

# セキュリティインシデント擬似体験イベント
本セクションでは、私が参加したセキュリティインシデント擬似体験イベントについて簡単に紹介します。

このワークショップでは、AWS環境で起こり得る典型的なセキュリティインシデントを模したログを用いて、チーム対抗形式のクイズが実施されました。参加者はインシデント調査の基本技術を学び、セキュリティ分析の経験がない方でも理解しやすいよう、解析方法に関する基礎的な説明もありました。

このイベントは、セキュリティ関連業務に従事する方、セキュリティインシデント対応の方法を学びたい方、システム開発・運用・保守に関わる方など、多くの方にとって非常に有益です。

イベントのより具体的な内容については、以下の記事を参照いただければと思います。詳細情報は公開できないため、興味がある方は是非イベントへの参加をオススメします👋

https://dev.classmethod.jp/articles/aws-top-engineer-2022-security-incident-workshop-report/
https://zenn.dev/vega_c/articles/7e29aa191d056f

# 擬似体験からの学び
## 調査の目的と必要性
セキュリティインシデントが発生した際の調査は、攻撃の成否を確認し、その影響を全面的に理解するために重要です。この調査は、単に技術的な側面だけでなく、ビジネスへの影響も考慮に入れる必要があります。

脅威検知のログだけでは攻撃が成功したかどうかを判断するのが難しいため、詳細な調査が不可欠です。攻撃が成功している場合、調査により根本原因（例：特定の脆弱性が突かれた）と被害範囲（例：漏洩した個人情報の件数）を特定します。この情報は、緊急対応、復旧作業、再発防止策の策定に不可欠です。

さらに重要なことは、セキュリティインシデントが事業へ与える影響の評価です。インシデントによって顧客の信頼が損なわれたり、法的責任が生じたりすることで、最終的に利益の損失につながる可能性があります。迅速な調査によって被害範囲を明確にし、適切なビジネス対応とコミュニケーション戦略を立てることで、これらのリスクを最小限に抑えることが可能です。

## 調査手法
![調査手法](/images/effective_internal_logging_infrastructure/how_to_investigate.png)

まず、脅威の検出結果を分析し、攻撃者の痕跡を確認します。この段階では、攻撃者が残した可能性のあるさまざまな兆候を慎重に評価します。例えば、特定の送信元IPからの不審なアクティビティが確認される場合、攻撃者が同じIPアドレスから別の攻撃を仕掛けている可能性があります。

このような仮説を立てた後、それが正しいかどうかを検証します。仮説が正しければ、その結果をさらに詳細に分析します。しかし、仮説が検証できない場合は、別の角度からの分析を試みたり、新しい仮説を立てたりします。

このプロセスは、迅速かつ効果的なセキュリティ対応のために、非常に重要です。調査手法の効率と正確性は、セキュリティインシデントの影響を最小限に抑えるために不可欠です。

## 予防的統制・発見的統制
### 予防的統制
予防的統制は、セキュリティインシデントが発生する前にリスクを最小限に抑えるための戦略です。このアプローチでは、潜在的なセキュリティリスクを識別し、これらを管理または除去するための措置が講じられます。

1. **ポリシーと手順**
明確なセキュリティポリシーと手順の策定は、組織内のセキュリティ意識を高め、一貫した対応を促進します。

2. **物理的および技術的な障壁**
不正アクセスを防ぐための物理的なセキュリティ措置や技術的な障壁（ファイアウォール、暗号化など）を設置します。

3. **アクセス管理**
アクセス権限を必要な人々にのみ与え、不必要なアクセスを制限することで、セキュリティリスクを軽減します。

### 発見的統制
発見的統制は、セキュリティインシデントが発生した後の迅速な検出と対応に重点を置きます。これには、既に発生しているかもしれないセキュリティ違反を識別し、迅速に対応するためのシステムやプロセスが含まれます。

1. **監視とアラート**
システムの監視と異常アラートは、セキュリティインシデントの早期発見に不可欠です。

2. **インシデントレスポンスプラン**
事前に定義されたインシデントレスポンスプランは、発見された脅威に迅速かつ効果的に対応するために重要です。

3. **事後分析とフィードバックループ**
インシデント発生後の分析とフィードバックは、将来的なセキュリティ向上に役立ちます。

# AWSの各種セキュリティ強化サービス
## セキュリティサービスの多様性
前述したセキュリティインシデント擬似体験イベントで、セキュリティ脅威への迅速かつ効果的な対応に必要な基礎知識と戦略が強調されました。AWSが提供する多様なセキュリティサービスは、これらの脅威に立ち向かうための重要なツールとなります。ここでは、AWSの主要なセキュリティサービスの機能について詳しく見ていきましょう。

![AWSの各種セキュリティ強化サービス](/images/effective_internal_logging_infrastructure/security_service.png)
参照: AWS Summit Online 2021「[AWS環境における脅威検知と対応](https://d1.awsstatic.com/events/jp/2021/summit-online/AWS-39_AWS_Summit_Online_2021_SEC03.pdf)」

### 防御
直接的な攻撃からシステムを守るためのサービスです。

#### AWS IAM (Identity and Access Management)
AWS IAMは、AWS環境内のリソースへのアクセスを安全に管理します。ユーザー、グループ、ロールを作成し、これらに対して細かいアクセス権限を設定することで、不正アクセスのリスクを低減し、セキュリティを強化します。

#### AWS WAF (Web Application Firewall)
AWS WAFは、ウェブアプリケーションを一般的なウェブ攻撃から保護するためのサービスです。SQLインジェクション、クロスサイトスクリプティングなどの攻撃をブロックし、ウェブトラフィックを監視してセキュリティを強化します。

#### AWS Shield
AWS Shieldは、DDoS攻撃に対する包括的な保護を提供します。基本的な保護はすべてのAWS顧客に無料で提供され、AWS Shield Advancedでは更に高度な保護と攻撃対応サポートを提供します。

### 検知
セキュリティ脅威や異常な行動を検出するためのサービスです。

#### Amazon GuardDuty
Amazon GuardDutyは、AWS環境内でのネットワークトラフィックとAWSアカウントの行動を監視し、機械学習と脅威インテリジェンスを用いて異常な活動や潜在的な脅威を識別します。この検出により、セキュリティインシデントへの迅速な対応が可能になります。

#### AWS SecurityHub
AWS SecurityHubは、AWS環境全体のセキュリティ状態を一元的に管理し、セキュリティアラートやコンプライアンスの状況を集約して表示します。これにより、セキュリティリスクの早期発見と対応が可能になります。

#### Amazon Inspector
Amazon Inspectorは、アプリケーションのセキュリティ脆弱性を自動的に検出し、セキュリティ向上のための推奨事項を提供します。このサービスは、アプリケーションのランタイムのセキュリティ評価を行い、セキュリティとコンプライアンスのリスクを低減します。

### 調査
セキュリティインシデントの原因を調査し、対応策を立てるためのサービスです。

#### AWS CloudTrail
AWS CloudTrailは、AWSアカウントのAPI呼び出し履歴を記録し、セキュリティイベントの追跡と原因究明に不可欠な情報を提供します。これにより、セキュリティインシデントの詳細な調査と分析が可能になります。

#### AWS Detective
AWS Detectiveは、AWSリソースとユーザーアクティビティに関連するデータを分析し、セキュリティインシデントの調査と解決を支援します。

#### VPC Flow Logs
VPC Flow Logsは、AWS Virtual Private Cloud内のネットワークトラフィック情報を記録します。セキュリティ分析、ネットワーク監視、異常検知に利用できます。

#### OpenSearch
OpenSearchは、ログデータの収集、分析、視覚化を実現します。セキュリティ監視やログ分析に有効で、異常パターンの検出やリアルタイム監視ダッシュボードの提供が可能です。

## セキュリティサービスの重要性

# 予算の課題と調整戦略
## コストとセキュリティ：予算制約の現実
## 戦略的調整：資金効率の良いセキュリティ対策

# おわりに

# 参考文献
https://linfordco.com/blog/importance-of-preventive-controls/
https://thecyphere.com/blog/security-controls/
https://erp.dentsusoken.com/blog/preventivedetective-controls-vol-84/
