---
title: "他のレコードと違う存在になりたいレコードへ"
emoji: "🤡"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: ["DB", "レコード", "識別子"]
published: false
---

# TL;DR

# はじめに

データーベースにおいて、データを一意に識別する手段は、システムの信頼性と効率の基盤となります。多くのアプリケーションフレームワークでは、シンプルで実績のある「Auto Increment」方式をデフォルトの識別子として採用しています。これは、シーケンシャルに増加する数値を使い、データベースの各レコードにユニークなIDを割り振る方法です。この単純さが、特に単一のデータベースサーバーを用いる場合や小規模なアプリケーションにおいては、その強みとなっています。

しかし、現代のアプリケーションは、単純なブログやウェブショップを超えて、分散システム、マイクロサービスアーキテクチャ、クラウドベースのスケーラビリティを要求されることが増えています。このような複雑なシステムでは、Auto IncrementのIDが持つ限界が顕著になり始めます。スケールアウトや複数の書き込みノードを持つ環境では、IDの衝突を避けるための追加的な工夫が必要となり、その管理が煩雑になることがあります。また、IDを予測可能なシーケンスにすることは、セキュリティー上のリスクを招く可能性もあります。

これらの課題を解決するために、UUID、ULID、Snowflakeのような新しい形式の識別子が提案されてきました。これらの技術は、ユニークさ、スケーラビリティ、生成の予測不可能性など、特定の利点を提供し、より要求の厳しい現代のアプリケーションのニーズに応えることを目的としています。本記事では、これらの識別子がどのように機能し、それぞれがどのような状況で最適であるかを解き明かしていきます。

# データ識別子

## Auto Increment

| id  | name  | email             |
| --- | ----- | ----------------- |
| 1   | Alice | alice@example.com |
| 2   | Bob   | bob@example.com   |
| 3   | Peter | peter@example.com |
| 4   | Tom   | tom@example.com   |

### 特徴

- 整数型で表され、通常1から始まり、新しいエントリーが追加されるごとに1ずつ増加します

## UUID v4

| id                                   | name  | email             |
| ------------------------------------ | ----- | ----------------- |
| 550e8400-e29b-41d4-a716-446655440000 | Alice | alice@example.com |
| 123e4567-e89b-12d3-a456-426614174000 | Bob   | bob@example.com   |
| 0c74f13f-fa83-4c48-9b33-689fed9a34b7 | Peter | peter@example.com |
| 5f9c7df8-3d59-4846-99fe-c4518e82c86f | Tom   | tom@example.com   |

### 特徴

- 128ビット長で、8-4-4-4-12の形式に分かれた16進表記を用いて表されます
- 全世界でユニークな値である可能性が非常に高く、衝突するリスクは極めて低いです

## ULID

| id                         | name  | email             |
| -------------------------- | ----- | ----------------- |
| 01ARZ3NDEKTSV4RRFFQ69G5FAV | Alice | alice@example.com |
| 01ARYZ6S41TSV4RRFFQ69G5FAV | Bob   | bob@example.com   |
| 01AS3YPYXJTSV4RRFFQ69G5FAV | Peter | peter@example.com |
| 01B2M2Y8JPTSV4RRFFQ69G5FAV | Tom   | tom@example.com   |

### 特徴

- 最初の48ビットはタイムスタンプで、残りの80ビットはランダムな値です
- Base32でエンコードされ、結果として26文字のアルファベットと数字のみで構成されます
- 時系列情報が組み込まれており、生成順にソートが可能です

## Snowflake

| id                  | name  | email             |
| ------------------- | ----- | ----------------- |
| 1382971839180339201 | Alice | alice@example.com |
| 1382971839180339202 | Bob   | bob@example.com   |
| 1382971839180339203 | Peter | peter@example.com |
| 1382971839180339204 | Tom   | tom@example.com   |

### 特徴

- Twitterによって開発された方式（[参考](https://github.com/twitter-archive/snowflake)）で、64ビットの整数で表されます
- タイムスタンプ、データセンターまたはワーカーノードのID、シーケンス番号の情報が含まれています
- 時系列情報が組み込まれているため、生成された順番に沿ってソート可能です

## UUID v7

| id                                   | name  | email             |
| ------------------------------------ | ----- | ----------------- |
| 01715b4c-b8e7-7d59-b6e7-6967c6c7c080 | Alice | alice@example.com |
| 01715b4c-b8e8-7dfa-a470-8969b8b8b890 | Bob   | bob@example.com   |
| 01715b4c-b8e9-7e1b-b6f8-9968d6d8d8a0 | Peter | peter@example.com |
| 01715b4c-b8ea-7e5c-b7e9-a678c7c8c8b0 | Tom   | tom@example.com   |

# データ識別子の比較

# ユースケース

# おわりに

# 参考文献
